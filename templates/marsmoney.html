<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>–ö—Ç–æ –∏–∑ –º–∞—Ä—Å–∏–∞–Ω –±–æ–≥–∞—á–µ?</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px;
    }

    h1 {
      color: #4a148c;
      margin-bottom: 10px;
    }

    .instructions {
      background-color: #fff3e0;
      border-left: 6px solid #ff9800;
      padding: 16px;
      margin-bottom: 30px;
      max-width: 800px;
      border-radius: 8px;
    }

    .instructions h2 {
      margin-top: 0;
    }

    .game-container {
      display: flex;
      justify-content: space-around;
      width: 100%;
      max-width: 800px;
      margin-bottom: 20px;
    }

    .martian {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 8px;
      background-color: white;
      min-height: 100px;
      width: 45%;
    }

    .bill {
      width: 40px;
      height: 60px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 16px;
    }

    .green { background-color: green; }
    .red { background-color: red; }
    .blue { background-color: blue; }

    .buttons {
      margin: 20px 0;
    }

    .buttons button {
      padding: 12px 24px;
      margin: 0 10px;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .buttons .left { background-color: #8bc34a; color: white; }
    .buttons .right { background-color: #03a9f4; color: white; }

    .result {
      font-size: 20px;
      font-weight: bold;
      color: #4a148c;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>–ö—Ç–æ –∏–∑ –º–∞—Ä—Å–∏–∞–Ω –±–æ–≥–∞—á–µ?</h1>
  <div class="instructions">
    <h2>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h2>
    <p>–ü–µ—Ä–µ–¥ –≤–∞–º–∏ –¥–≤–∞ –º–∞—Ä—Å–∏–∞–Ω–∏–Ω–∞. –£ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∏—Ö –µ—Å—Ç—å –Ω–∞–±–æ—Ä –∫—É–ø—é—Ä —Ç—Ä—ë—Ö —Ü–≤–µ—Ç–æ–≤:</p>
    <ul>
      <li><strong style="color: green;">–ó–µ–ª—ë–Ω–∞—è</strong> –∫—É–ø—é—Ä–∞ ‚Äî 1 –º–∞—Ä—Å–∏–∞–Ω—Å–∫–∏–π –¥–æ–ª–ª–∞—Ä</li>
      <li><strong style="color: red;">–ö—Ä–∞—Å–Ω–∞—è</strong> –∫—É–ø—é—Ä–∞ ‚Äî 2 –º–∞—Ä—Å–∏–∞–Ω—Å–∫–∏—Ö –¥–æ–ª–ª–∞—Ä–∞</li>
      <li><strong style="color: blue;">–°–∏–Ω—è—è</strong> –∫—É–ø—é—Ä–∞ ‚Äî 5 –º–∞—Ä—Å–∏–∞–Ω—Å–∫–∏—Ö –¥–æ–ª–ª–∞—Ä–æ–≤</li>
    </ul>
    <p>–í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —É –∫–æ–≥–æ –∏–∑ –¥–≤—É—Ö –º–∞—Ä—Å–∏–∞–Ω –æ–±—â–∞—è —Å—É–º–º–∞ –±–æ–ª—å—à–µ. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <strong>"–°–ª–µ–≤–∞ –±–æ–≥–∞—á–µ"</strong> –∏–ª–∏ <strong>"–°–ø—Ä–∞–≤–∞ –±–æ–≥–∞—á–µ"</strong>.</p>
    <p>–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ‚Äî –≤—ã —É–≤–∏–¥–∏—Ç–µ –Ω–∞–¥–ø–∏—Å—å <strong>"–ü—Ä–∞–≤–∏–ª—å–Ω–æ!"</strong>. –ï—Å–ª–∏ –æ—à–∏–±—ë—Ç–µ—Å—å ‚Äî <strong>"–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ"</strong>. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞.</p>
  </div>
  <div class="game-container">
    <div class="martian" id="martian1"></div>
    <div class="martian" id="martian2"></div>
  </div>
  <div class="buttons">
    <button class="left" onclick="checkAnswer(1)">–°–ª–µ–≤–∞ –±–æ–≥–∞—á–µ</button>
    <button class="right" onclick="checkAnswer(2)">–°–ø—Ä–∞–≤–∞ –±–æ–≥–∞—á–µ</button>
  </div>
  <div class="result" id="result"></div>
  <a href="/" class="btn-back">‚Üê –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>

  <style>
	.btn-back {
		display: inline-block;
		margin: 20px;
		padding: 10px 20px;
		background-color: #8a2be2;
		color: white;
		text-decoration: none;
		border-radius: 8px;
		font-weight: bold;
		transition: background-color 0.3s ease;
	}
	.btn-back:hover {
		background-color: #6d1cb3;
	}
  </style>
  <script>
    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i].trim();
          if (cookie.substring(0, name.length + 1) === (name + '=')) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }
    const csrftoken = getCookie('csrftoken');
  </script>  
  <script>
    const bills = [
      { color: 'green', value: 1 },
      { color: 'red', value: 2 },
      { color: 'blue', value: 5 }
    ];

    let martian1Bills = [];
    let martian2Bills = [];

    function getRandomBills() {
      const arr = [];
      const count = Math.floor(Math.random() * 6) + 3;
      for (let i = 0; i < count; i++) {
        const random = bills[Math.floor(Math.random() * bills.length)];
        arr.push(random);
      }
      return arr;
    }

    function renderBills(containerId, bills) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';
      bills.forEach(bill => {
        const div = document.createElement('div');
        div.className = `bill ${bill.color}`;
        div.innerText = '$';
        container.appendChild(div);
      });
    }

    function total(bills) {
      return bills.reduce((sum, b) => sum + b.value, 0);
    }

    function newRound() {
      martian1Bills = getRandomBills();
      martian2Bills = getRandomBills();
      renderBills('martian1', martian1Bills);
      renderBills('martian2', martian2Bills);
      document.getElementById('result').innerText = '';
    }

    function awardPoints() {
      fetch('/add_score/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': csrftoken,
        },
        body: JSON.stringify({points: 5}),
      })
      .then(response => response.json())
      .then(data => {
        console.log('–û—á–∫–∏ –Ω–∞—á–∏—Å–ª–µ–Ω—ã! –ù–æ–≤—ã–π —Å—á—ë—Ç:', data.new_score);
      })
      .catch(error => {
        console.error('–û—à–∏–±–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –æ—á–∫–æ–≤:', error);
      });
    }

    function checkAnswer(choice) {
      const total1 = total(martian1Bills);
      const total2 = total(martian2Bills);
      let correct = (choice === 1 && total1 > total2) || (choice === 2 && total2 > total1);

      const result = document.getElementById('result');
      result.innerText = correct ? '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! üëç' : '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ üò¢';

      if (correct) {
        awardPoints(); // üëâ –Ω–∞—á–∏—Å–ª—è–µ–º –æ—á–∫–∏ —Ç–æ–ª—å–∫–æ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
      }

      setTimeout(newRound, 1500);
    }

    // Start the first round
    newRound();
  </script>
</body>
</html>